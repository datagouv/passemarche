<div class="fr-container">
  <div class="fr-grid-row">
    <div class="fr-col-12">
      <%= render 'admin/shared/navigation' %>

      <nav role="navigation" class="fr-breadcrumb" aria-label="vous êtes ici :">
        <ol class="fr-breadcrumb__list">
          <li>
            <%= link_to t('admin.navigation.editors'), admin_editors_path, class: "fr-breadcrumb__link" %>
          </li>
          <li>
            <a class="fr-breadcrumb__link" aria-current="page"><%= @editor.name %></a>
          </li>
        </ol>
      </nav>

      <h1><%= @editor.name %></h1>

      <div class="fr-grid-row fr-grid-row--gutters">
        <div class="fr-col-12 fr-col-md-6">
          <div class="fr-card">
            <div class="fr-card__body">
              <h2 class="fr-card__title"><%= t('admin.editors.show.information') %></h2>
              <div class="fr-card__content">
                <p><strong><%= t('admin.shared.authorized') %> :</strong>
                  <% if @editor.authorized %>
                    <span class="fr-badge fr-badge--success"><%= t('admin.shared.yes') %></span>
                  <% else %>
                    <span class="fr-badge fr-badge--error"><%= t('admin.shared.no') %></span>
                  <% end %>
                </p>
                <p><strong><%= t('admin.shared.active') %> :</strong>
                  <% if @editor.active %>
                    <span class="fr-badge fr-badge--success"><%= t('admin.shared.yes') %></span>
                  <% else %>
                    <span class="fr-badge fr-badge--error"><%= t('admin.shared.no') %></span>
                  <% end %>
                </p>
                <p><strong><%= t('admin.editors.show.mds_markets') %></strong>
                  <% if @editor.can_create_defense_markets %>
                    <span class="fr-badge fr-badge--success"><%= t('admin.shared.authorized') %></span>
                  <% else %>
                    <span class="fr-badge fr-badge--warning"><%= t('admin.shared.not_authorized') %></span>
                  <% end %>
                </p>
                <p><strong><%= t('admin.editors.show.created_at') %></strong> <%= l(@editor.created_at, format: :long) %></p>
              </div>
            </div>
          </div>
        </div>

        <div class="fr-col-12 fr-col-md-6">
          <div class="fr-card">
            <div class="fr-card__body">
              <h2 class="fr-card__title"><%= t('admin.editors.show.oauth_credentials') %></h2>
              <div class="fr-card__content">
                <p><strong><%= t('admin.editors.show.client_id') %></strong> <%= @editor.client_id %></p>
                <p><strong><%= t('admin.editors.show.client_secret') %></strong></p>
                <% if current_user_can_modify? %>
                  <div data-controller="webhook-secret-toggle">
                    <div class="fr-input-group" style="max-width: 500px;">
                      <input type="text"
                             class="fr-input fr-text--sm"
                             value="<%= '•' * 64 %>"
                             readonly
                             data-webhook-secret-toggle-target="field"
                             data-webhook-secret-toggle-masked-value="<%= '•' * 64 %>"
                             data-webhook-secret-toggle-real-value="<%= @editor.client_secret %>">
                      <button type="button"
                              class="fr-btn fr-btn--sm fr-btn--tertiary-no-outline"
                              data-action="click->webhook-secret-toggle#toggle"
                              data-webhook-secret-toggle-target="button"
                              title="<%= t('admin.shared.show_hide_secret') %>">
                        <span data-webhook-secret-toggle-target="icon" class="fr-icon-eye-line" aria-hidden="true"></span>
                      </button>
                    </div>
                  </div>
                <% else %>
                  <div class="fr-input-group" style="max-width: 500px;">
                    <input type="text" class="fr-input fr-text--sm" value="<%= '•' * 64 %>" readonly>
                  </div>
                <% end %>
              </div>
            </div>
          </div>
        </div>

        <div class="fr-col-12 fr-col-md-6">
          <div class="fr-card">
            <div class="fr-card__body">
              <h2 class="fr-card__title"><%= t('admin.editors.show.statistics_title') %></h2>
              <div class="fr-card__content">
                <p class="fr-mb-2w"><%= t('admin.editors.show.statistics_description') %></p>
                <%= link_to t('admin.editors.show.view_statistics'),
                            admin_dashboard_path(editor_id: @editor.id),
                            class: "fr-btn fr-btn--secondary fr-btn--sm fr-icon-bar-chart-box-line fr-btn--icon-left" %>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="fr-grid-row fr-mt-3w">
        <div class="fr-col-12">
          <div class="fr-card">
            <div class="fr-card__body">
              <h2 class="fr-card__title"><%= t('admin.editors.show.webhook_config') %></h2>
              <div class="fr-card__content">
                <% if @editor.webhook_configured? %>
                  <p><strong><%= t('admin.editors.show.webhook_url') %></strong> <%= @editor.completion_webhook_url %></p>
                  <p><strong><%= t('admin.editors.show.redirect_url') %></strong> <%= @editor.redirect_url || t('admin.shared.not_configured') %></p>
                  <p><strong><%= t('admin.editors.show.secret_configured') %></strong>
                    <% if @editor.webhook_secret.present? %>
                      <span class="fr-badge fr-badge--success"><%= t('admin.shared.yes') %></span>
                      <% if current_user_can_modify? %>
                        <div class="fr-mt-2w" data-controller="webhook-secret-toggle">
                          <div class="fr-input-group" style="max-width: 400px;">
                            <input type="text"
                                   class="fr-input fr-text--sm"
                                   value="••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••"
                                   readonly
                                   data-webhook-secret-toggle-target="field"
                                   data-webhook-secret-toggle-masked-value="••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••"
                                   data-webhook-secret-toggle-real-value="<%= @editor.webhook_secret %>" />
                            <button type="button"
                                    class="fr-btn fr-btn--sm fr-btn--tertiary-no-outline fr-icon-eye-line"
                                    data-action="click->webhook-secret-toggle#toggle"
                                    data-webhook-secret-toggle-target="button"
                                    title="<%= t('admin.shared.show_secret') %>">
                              <span data-webhook-secret-toggle-target="icon" class="fr-icon-eye-line" aria-hidden="true"></span>
                            </button>
                          </div>
                        </div>
                      <% else %>
                        <div class="fr-mt-2w">
                          <div class="fr-input-group" style="max-width: 400px;">
                            <input type="text" class="fr-input fr-text--sm"
                                   value="••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••" readonly />
                          </div>
                        </div>
                      <% end %>
                    <% else %>
                      <span class="fr-badge fr-badge--warning"><%= t('admin.shared.no') %></span>
                    <% end %>
                  </p>
                <% else %>
                  <p class="fr-text--sm"><%= t('admin.editors.show.webhook_not_configured') %></p>
                <% end %>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="fr-mt-3w">
        <%= admin_action_link_to t('admin.shared.edit'), edit_admin_editor_path(@editor), class: "fr-btn fr-btn--secondary" %>
        <%= admin_action_link_to t('admin.shared.delete'), admin_editor_path(@editor),
                    method: :delete,
                    data: { confirm: t('admin.editors.show.confirm_delete') },
                    class: "fr-btn fr-btn--tertiary" %>
        <%= link_to t('admin.shared.back_to_list'), admin_editors_path, class: "fr-btn fr-btn--tertiary-no-outline" %>
      </div>
    </div>
  </div>
</div>
