<% if @market_attributes.empty? %>
  <div class="fr-callout">
    <p class="fr-callout__text"><%= t('admin.socle_de_base.filters.no_results') %></p>
    <%= link_to t('admin.socle_de_base.filters.reset'), admin_socle_de_base_index_path, class: "fr-btn fr-btn--secondary" %>
  </div>
<% else %>
<div class="fr-table">
  <table>
    <thead>
      <tr>
        <th scope="col"></th>
        <th scope="col"><%= t('admin.socle_de_base.table.headers.category') %></th>
        <th scope="col"><%= t('admin.socle_de_base.table.headers.subcategory') %></th>
        <th scope="col"><%= t('admin.socle_de_base.table.headers.field') %></th>
        <th scope="col"><%= t('admin.socle_de_base.table.headers.market_type') %></th>
        <th scope="col"><%= t('admin.socle_de_base.table.headers.source') %></th>
        <th scope="col"><%= t('admin.socle_de_base.table.headers.actions') %></th>
      </tr>
    </thead>
    <tbody <% if current_user_can_modify? %>
             data-controller="drag-reorder"
             data-drag-reorder-url-value="<%= reorder_admin_socle_de_base_index_path %>"
           <% end %>>
      <% @market_attributes.each do |market_attribute| %>
        <% presenter = SocleDeBasePresenter.new(market_attribute) %>
        <tr data-item-id="<%= market_attribute.id %>">
          <td <% if current_user_can_modify? %>data-drag-handle style="cursor: grab;"<% end %>>
            <% if current_user_can_modify? %>
              <%= render 'admin/socle_de_base/drag_handle_icon' %>
            <% end %>
          </td>
          <td><%= presenter.category_label %></td>
          <td><%= presenter.subcategory_label %></td>
          <td><%= presenter.field_name %></td>
          <td style="white-space: nowrap">
            <% presenter.market_type_badges.each do |badge| %>
              <span class="fr-badge fr-badge--sm<%= ' fr-badge--no-icon' unless badge[:active] %><%= ' fr-badge--blue-cumulus' if badge[:active] %>"
                    <% unless badge[:active] %>style="opacity: 0.4"<% end %>>
                <%= t("admin.socle_de_base.market_type_badges.#{badge[:code]}") %>
              </span>
            <% end %>
          </td>
          <td>
            <span class="fr-badge fr-badge--sm <%= presenter.source_badge_class %>">
              <%= presenter.source_badge %>
            </span>
          </td>
          <td style="white-space: nowrap">
            <%= admin_action_link_to t('admin.socle_de_base.edit_button'),
                                     admin_socle_de_base_path(market_attribute),
                                     class: "fr-btn fr-btn--secondary fr-btn--sm fr-mr-1w" %>
            <%= button_to t('admin.socle_de_base.archive_button'),
                          archive_admin_socle_de_base_path(market_attribute),
                          method: :patch,
                          class: "fr-btn fr-btn--tertiary fr-btn--sm",
                          disabled: !current_user_can_modify?,
                          form: { data: { turbo_confirm: t('admin.socle_de_base.archive.confirm') } } %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>
<% end %>
