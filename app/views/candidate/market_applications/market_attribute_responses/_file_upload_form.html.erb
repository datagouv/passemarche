<%
  file_info = market_attribute_response.file
  required = market_attribute_response.market_attribute.required?
%>

<div class="fr-upload-group">
  <%= form.fields_for :market_attribute_responses, market_attribute_response do |response_form| %>
    <%= response_form.hidden_field :id %>
    <%= response_form.hidden_field :market_attribute_id %>
    
    <%= response_form.label :file, 
          t("form_fields.candidate.fields.#{market_attribute_response.market_attribute.key}.name", 
            default: market_attribute_response.market_attribute.key.humanize),
          class: "fr-label #{'fr-label--required' if required}" %>
    
    <% if t("form_fields.candidate.fields.#{market_attribute_response.market_attribute.key}.description", default: nil).present? %>
      <span class="fr-hint-text">
        <%= t("form_fields.candidate.fields.#{market_attribute_response.market_attribute.key}.description") %>
      </span>
    <% end %>
    
    <%= response_form.file_field :file, 
          class: "fr-upload",
          required: required,
          accept: ".pdf,.doc,.docx,.jpg,.jpeg,.png" %>
    
    <% if file_info.present? %>
      <div class="fr-mt-2w">
        <p class="fr-text--sm">
          <strong>Fichier actuel :</strong> <%= file_info['name'] || 'Fichier téléchargé' %>
        </p>
      </div>
    <% end %>
  <% end %>
</div>