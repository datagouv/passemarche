<div class="fr-container fr-py-8w">
  <div class="fr-mb-6w">
    <h1 class="fr-mb-2w">
      <span class="fr-icon-government-line fr-icon--lg" aria-hidden="true"></span>
      √âditeur de march√©s publics - Demo
    </h1>
    <p class="fr-text--lead">
      Interface de d√©monstration pour tester l'int√©gration avec Voie Rapide
    </p>
  </div>

  <% if @completed_market_identifier %>
    <div class="fr-alert fr-alert--success fr-mb-4w">
      <h3 class="fr-alert__title">‚úÖ March√© configur√© avec succ√®s !</h3>
      <p>
        Le march√© <strong><%= @completed_market_identifier %></strong> est maintenant pr√™t √† recevoir des candidatures.
        <br>
        <a href="/buyer/markets/<%= @completed_market_identifier %>" class="fr-link">
          Voir le d√©tail du march√©
        </a>
      </p>
    </div>
  <% end %>

  <!-- Authentication Status -->
  <% if @current_token&.valid? %>
    <div class="fr-notice fr-notice--info fr-mb-4w">
      <div class="fr-container">
        <div class="fr-notice__body">
          <p class="fr-notice__title">
            üîê Authentifi√© aupr√®s de Voie Rapide
          </p>
          <p class="fr-notice__desc">
            Token valide pendant encore <%= @current_token.time_until_expiry / 60 %> minutes
          </p>
        </div>
      </div>
    </div>
  <% else %>
    <div class="fr-notice fr-notice--warning fr-mb-4w">
      <div class="fr-container">
        <div class="fr-notice__body">
          <p class="fr-notice__title">
            ‚ö†Ô∏è Non authentifi√©
          </p>
          <p class="fr-notice__desc">
            Certaines fonctionnalit√©s n√©cessitent une authentification.
            <a href="/technical" class="fr-link">Aller au tableau de bord technique</a>
          </p>
        </div>
      </div>
    </div>
  <% end %>

  <!-- Role-Based Actions -->

  <!-- Buyer Section -->
  <div class="fr-card fr-card--blue-ecume fr-mb-4w">
    <div class="fr-card__body">
      <div class="fr-card__content">
        <h2 class="fr-card__title">
          <span class="fr-icon-building-line fr-icon--lg" aria-hidden="true"></span>
          Acheteur Public
        </h2>
        <p class="fr-card__desc">
          Cr√©ez des march√©s publics et consultez les candidatures re√ßues
        </p>
      </div>
      <div class="fr-card__footer">
        <div class="fr-btns-group fr-btns-group--inline-lg fr-btns-group--icon-left">
          <a href="/buyer/markets/new" class="fr-btn fr-btn--primary">
            <span class="fr-icon-add-circle-line" aria-hidden="true"></span>
            Cr√©er un nouveau march√©
          </a>
          <a href="/buyer" class="fr-btn fr-btn--secondary">
            <span class="fr-icon-layout-grid-line" aria-hidden="true"></span>
            Tableau de bord acheteur
          </a>
        </div>
      </div>
    </div>
  </div>

  <!-- Candidate Section -->
  <div class="fr-card fr-card--green-emeraude fr-mb-4w">
    <div class="fr-card__body">
      <div class="fr-card__content">
        <h2 class="fr-card__title">
          <span class="fr-icon-user-line fr-icon--lg" aria-hidden="true"></span>
          Candidat
        </h2>
        <p class="fr-card__desc">
          Consultez les march√©s disponibles et g√©rez vos candidatures
        </p>
      </div>
      <div class="fr-card__footer">
        <div class="fr-btns-group fr-btns-group--inline-lg fr-btns-group--icon-left">
          <a href="/candidate/markets" class="fr-btn fr-btn--primary">
            <span class="fr-icon-file-text-line" aria-hidden="true"></span>
            Consulter les march√©s et candidater
          </a>
          <a href="/candidate" class="fr-btn fr-btn--secondary">
            <span class="fr-icon-folder-2-line" aria-hidden="true"></span>
            Acc√©der √† une ancienne candidature
          </a>
        </div>
      </div>
    </div>
  </div>

  <!-- Technical Section -->
  <div class="fr-card fr-card--grey fr-mb-4w">
    <div class="fr-card__body">
      <div class="fr-card__content">
        <h2 class="fr-card__title">
          <span class="fr-icon-settings-5-line fr-icon--lg" aria-hidden="true"></span>
          Technique
        </h2>
        <p class="fr-card__desc">
          G√©rez l'authentification OAuth et consultez les donn√©es techniques de l'int√©gration.
        </p>
      </div>
      <div class="fr-card__footer">
        <a href="/technical" class="fr-btn fr-btn--secondary fr-btn--icon-left">
          <span class="fr-icon-settings-5-line" aria-hidden="true"></span>
          Tableau de bord technique
        </a>
      </div>
    </div>
  </div>

  <!-- Quick Links -->
  <div class="fr-mt-6w">
    <h2 class="fr-mb-3w">Liens rapides</h2>
    <div class="fr-grid-row fr-grid-row--gutters">
      <div class="fr-col-12 fr-col-md-6">
        <div class="fr-callout">
          <h3 class="fr-callout__title">üìñ Documentation</h3>
          <p class="fr-callout__text">
            Consultez la documentation de Voie Rapide pour comprendre l'int√©gration OAuth et les webhooks.
          </p>
          <a class="fr-link" href="<%= ENV['FAST_TRACK_URL'] %>" target="_blank" rel="noopener external">
            Acc√©der √† Voie Rapide
          </a>
        </div>
      </div>
      <div class="fr-col-12 fr-col-md-6">
        <div class="fr-callout">
          <h3 class="fr-callout__title">üîß Configuration</h3>
          <p class="fr-callout__text">
            CLIENT_ID: <code><%= ENV.fetch('CLIENT_ID', 'non configur√©')[0..10] %>...</code><br>
            FAST_TRACK_URL: <code><%= ENV.fetch('FAST_TRACK_URL', 'non configur√©') %></code>
          </p>
        </div>
      </div>
    </div>
  </div>
</div>
